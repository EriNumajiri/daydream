<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>質問1</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

    

</head>
<body>
    <div class="header">
        <h3>あなたの人生はどのような天気ですか？</h3>
    </div>

    <table>
        <tr>
        <td>過去</td>

        <td>現在</td>

        <td>未来</td>
        </tr>
    </table>
    


    <div class="swipers">
        <div class="swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide"><img src="images/sunny.png"></div>
            <div class="swiper-slide"><img src="images/cloudy.png"></div>
            <div class="swiper-slide"><img src="images/rain.png"></div>
            <div class="swiper-slide"><img src="images/snowy.png"></div>
        </div>

        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        </div>


        <div class="swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide"><img src="images/sunny.png"></div>
            <div class="swiper-slide"><img src="images/cloudy.png"></div>
            <div class="swiper-slide"><img src="images/rain.png"></div>
            <div class="swiper-slide"><img src="images/snowy.png"></div>
        </div>

        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        </div>


        <div class="swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide"><img src="images/sunny.png"></div>
            <div class="swiper-slide"><img src="images/cloudy.png"></div>
            <div class="swiper-slide"><img src="images/rain.png"></div>
            <div class="swiper-slide"><img src="images/snowy.png"></div>
        </div>

        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        </div>
    </div>

    <a href="#" class="btnripple">　　　決定　　　</a>


    
    <div class="footer">
        <br>
    </div>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
    const swiper = new Swiper('.swiper', {
    direction: 'vertical',
    loop: true,
    slidesPerView: 1,
    centeredSlides: true,
    mousewheel: true,
    pagination: { el: '.swiper-pagination', clickable: true },
    navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
    });
    </script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const swipers = document.querySelectorAll('.swiper');

        // Swiper 初期化
        swipers.forEach(sw => {
            new Swiper(sw, {
                direction: 'vertical',
                loop: true,
                slidesPerView: 1,
                centeredSlides: true,
                mousewheel: true,
                pagination: { el: sw.querySelector('.swiper-pagination'), clickable: true },
                navigation: { nextEl: sw.querySelector('.swiper-button-next'), prevEl: sw.querySelector('.swiper-button-prev') },
            });
        });

        // 決定ボタン押下時
        document.querySelector('.btnripple').addEventListener('click', () => {
            const currentSelections = []; // 今回の選択のみ

            swipers.forEach(sw => {
                const activeSlide = sw.querySelector('.swiper-slide.swiper-slide-active img');
                let val = 0;
                if(activeSlide) {
                    const src = activeSlide.getAttribute('src');
                    if(src.includes('sunny')) val = 1;
                    else if(src.includes('cloudy')) val = 2;
                    else if(src.includes('rain')) val = 3;
                    else if(src.includes('snowy')) val = 4;
                }
                currentSelections.push(val);
            });

            console.log('今回の選択:', currentSelections);

            // Flask に JSON 送信
            fetch('/submit', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ selections: currentSelections }) 
            })
            .then(res => res.text())
            .then(msg => console.log(msg))
            .catch(err => console.error(err));
        });
    });
    </script>




</body>
</html>